<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Round Robin Tournament</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/lucide@latest/dist/umd/lucide.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
</head>
<body class="bg-[#0a0a0b] min-h-screen font-['Inter'] text-white antialiased">

    <div class="max-w-5xl mx-auto px-4 sm:px-6 py-8 sm:py-12">

        <!-- Header -->
        <div class="mb-8 sm:mb-12">
            <div class="flex items-center gap-3 mb-2">
                <div class="w-8 h-8 rounded-lg bg-gradient-to-br from-violet-500 to-fuchsia-500 flex items-center justify-center">
                    <i data-lucide="trophy" class="w-4 h-4 text-white"></i>
                </div>
                <span class="text-sm font-medium text-zinc-500 uppercase tracking-wider">Tournament</span>
            </div>
            <h1 class="text-3xl sm:text-4xl font-semibold tracking-tight text-white">Round Robin</h1>
            <p class="text-zinc-500 mt-2 text-sm sm:text-base">Create and manage your tournament brackets with automatic scheduling</p>
        </div>

        <!-- Setup Section -->
        <div id="setupSection" class="space-y-6">

            <!-- Team Selection Card -->
            <div class="bg-zinc-900/50 border border-zinc-800 rounded-xl p-6">
                <div class="flex items-center gap-2 mb-4">
                    <i data-lucide="users" class="w-4 h-4 text-zinc-400"></i>
                    <h2 class="text-sm font-medium text-zinc-300">Select Teams</h2>
                </div>

                <div class="grid grid-cols-3 sm:grid-cols-6 gap-2 sm:gap-3" id="teamSelection">
                    <!-- Team buttons generated by JS -->
                </div>
            </div>

            <!-- Team Preview -->
            <div class="bg-zinc-900/50 border border-zinc-800 rounded-xl p-6">
                <div class="flex items-center justify-between mb-4">
                    <div class="flex items-center gap-2">
                        <i data-lucide="eye" class="w-4 h-4 text-zinc-400"></i>
                        <h2 class="text-sm font-medium text-zinc-300">Preview</h2>
                    </div>
                    <span class="text-xs text-zinc-500" id="matchCountPreview">0 matches</span>
                </div>

                <div class="flex flex-wrap gap-2" id="teamsPreview">
                    <!-- Team badges generated by JS -->
                </div>
            </div>

            <!-- Start Button -->
            <button onclick="startTournament()" class="w-full bg-white hover:bg-zinc-100 text-zinc-900 font-medium py-3 px-4 rounded-xl transition-all duration-200 flex items-center justify-center gap-2 group">
                <span>Start Tournament</span>
                <i data-lucide="arrow-right" class="w-4 h-4 group-hover:translate-x-0.5 transition-transform"></i>
            </button>

        </div>

        <!-- Tournament Section -->
        <div id="tournamentSection" class="hidden space-y-6">

            <!-- Stats Bar -->
            <div class="grid grid-cols-2 sm:grid-cols-4 gap-3">
                <div class="bg-zinc-900/50 border border-zinc-800 rounded-xl p-4">
                    <p class="text-xs text-zinc-500 mb-1">Teams</p>
                    <p class="text-xl font-semibold" id="statTeams">0</p>
                </div>
                <div class="bg-zinc-900/50 border border-zinc-800 rounded-xl p-4">
                    <p class="text-xs text-zinc-500 mb-1">Matches</p>
                    <p class="text-xl font-semibold" id="statMatches">0</p>
                </div>
                <div class="bg-zinc-900/50 border border-zinc-800 rounded-xl p-4">
                    <p class="text-xs text-zinc-500 mb-1">Completed</p>
                    <p class="text-xl font-semibold" id="statCompleted">0</p>
                </div>
                <div class="bg-zinc-900/50 border border-zinc-800 rounded-xl p-4">
                    <p class="text-xs text-zinc-500 mb-1">Goals</p>
                    <p class="text-xl font-semibold" id="statGoals">0</p>
                </div>
            </div>

            <!-- Action Buttons -->
            <div class="flex gap-3">
                <button onclick="randomizeScores()" class="flex-1 bg-zinc-800 hover:bg-zinc-700 border border-zinc-700 text-white font-medium py-2.5 px-4 rounded-xl transition-all duration-200 flex items-center justify-center gap-2">
                    <i data-lucide="shuffle" class="w-4 h-4"></i>
                    <span class="text-sm">Randomize</span>
                </button>
                <button onclick="clearScores()" class="flex-1 bg-zinc-800 hover:bg-zinc-700 border border-zinc-700 text-white font-medium py-2.5 px-4 rounded-xl transition-all duration-200 flex items-center justify-center gap-2">
                    <i data-lucide="eraser" class="w-4 h-4"></i>
                    <span class="text-sm">Clear</span>
                </button>
                <button onclick="resetTournament()" class="bg-zinc-800 hover:bg-red-500/20 hover:border-red-500/50 border border-zinc-700 text-white font-medium py-2.5 px-4 rounded-xl transition-all duration-200 flex items-center justify-center gap-2">
                    <i data-lucide="rotate-ccw" class="w-4 h-4"></i>
                </button>
            </div>

            <!-- Standings -->
            <div class="bg-zinc-900/50 border border-zinc-800 rounded-xl overflow-hidden">
                <div class="px-6 py-4 border-b border-zinc-800 flex items-center gap-2">
                    <i data-lucide="bar-chart-3" class="w-4 h-4 text-zinc-400"></i>
                    <h2 class="text-sm font-medium text-zinc-300">Standings</h2>
                </div>

                <div class="overflow-x-auto">
                    <table class="w-full">
                        <thead>
                            <tr class="text-xs text-zinc-500 border-b border-zinc-800/50">
                                <th class="text-left py-3 px-6 font-medium">#</th>
                                <th class="text-left py-3 px-4 font-medium">Team</th>
                                <th class="text-center py-3 px-2 font-medium">W</th>
                                <th class="text-center py-3 px-2 font-medium">D</th>
                                <th class="text-center py-3 px-2 font-medium">L</th>
                                <th class="text-center py-3 px-2 font-medium hidden sm:table-cell">GF</th>
                                <th class="text-center py-3 px-2 font-medium hidden sm:table-cell">GA</th>
                                <th class="text-center py-3 px-2 font-medium">GD</th>
                                <th class="text-center py-3 px-6 font-medium">Pts</th>
                            </tr>
                        </thead>
                        <tbody id="standingsBody" class="text-sm">
                            <!-- Generated by JS -->
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- Matches Grid -->
            <div class="bg-zinc-900/50 border border-zinc-800 rounded-xl overflow-hidden">
                <div class="px-6 py-4 border-b border-zinc-800 flex items-center gap-2">
                    <i data-lucide="calendar" class="w-4 h-4 text-zinc-400"></i>
                    <h2 class="text-sm font-medium text-zinc-300">Match Schedule</h2>
                </div>

                <div class="divide-y divide-zinc-800/50" id="matchesContainer">
                    <!-- Generated by JS -->
                </div>
            </div>

            <!-- Tiebreaker Info -->
            <div class="bg-zinc-900/30 border border-zinc-800/50 rounded-xl p-5">
                <div class="flex items-center gap-2 mb-3">
                    <i data-lucide="info" class="w-4 h-4 text-zinc-500"></i>
                    <h3 class="text-xs font-medium text-zinc-400 uppercase tracking-wider">Tie-Breaker Rules</h3>
                </div>
                <div class="grid grid-cols-2 sm:grid-cols-4 gap-4 text-sm">
                    <div class="flex items-center gap-2">
                        <span class="w-5 h-5 rounded-full bg-zinc-800 text-zinc-400 text-xs flex items-center justify-center font-medium">1</span>
                        <span class="text-zinc-500">Points</span>
                    </div>
                    <div class="flex items-center gap-2">
                        <span class="w-5 h-5 rounded-full bg-zinc-800 text-zinc-400 text-xs flex items-center justify-center font-medium">2</span>
                        <span class="text-zinc-500">Goal Diff</span>
                    </div>
                    <div class="flex items-center gap-2">
                        <span class="w-5 h-5 rounded-full bg-zinc-800 text-zinc-400 text-xs flex items-center justify-center font-medium">3</span>
                        <span class="text-zinc-500">Goals For</span>
                    </div>
                    <div class="flex items-center gap-2">
                        <span class="w-5 h-5 rounded-full bg-zinc-800 text-zinc-400 text-xs flex items-center justify-center font-medium">4</span>
                        <span class="text-zinc-500">Head-to-Head</span>
                    </div>
                </div>
            </div>

        </div>
    </div>

    <script>
        const TEAMS = [
            { name: 'Red', color: 'bg-red-500', text: 'text-white', border: 'border-red-500' },
            { name: 'Green', color: 'bg-emerald-500', text: 'text-white', border: 'border-emerald-500' },
            { name: 'Blue', color: 'bg-blue-500', text: 'text-white', border: 'border-blue-500' },
            { name: 'Yellow', color: 'bg-yellow-400', text: 'text-zinc-900', border: 'border-yellow-400' },
            { name: 'Orange', color: 'bg-orange-500', text: 'text-white', border: 'border-orange-500' },
            { name: 'Magenta', color: 'bg-fuchsia-500', text: 'text-white', border: 'border-fuchsia-500' }
        ];

        let selectedCount = 4;
        let teams = [];
        let matches = [];
        let scores = {};

        document.addEventListener('DOMContentLoaded', () => {
            renderTeamSelection();
            updatePreview();
            lucide.createIcons();
        });

        function renderTeamSelection() {
            const container = document.getElementById('teamSelection');
            container.innerHTML = TEAMS.map((team, idx) => `
                <button onclick="selectTeamCount(${idx + 1})"
                        id="teamBtn-${idx}"
                        class="team-select-btn relative aspect-square rounded-xl border-2 transition-all duration-200 flex flex-col items-center justify-center gap-1
                               ${idx < selectedCount
                                   ? team.color + ' border-transparent shadow-lg shadow-' + team.name.toLowerCase() + '-500/20'
                                   : 'bg-zinc-800/50 border-zinc-700 hover:border-zinc-600'}">
                    <span class="text-xs font-medium ${idx < selectedCount ? team.text : 'text-zinc-500'}">${team.name}</span>
                </button>
            `).join('');
        }

        function selectTeamCount(count) {
            if (count < 2) count = 2;
            selectedCount = count;
            renderTeamSelection();
            updatePreview();
        }

        function updatePreview() {
            const preview = document.getElementById('teamsPreview');
            const matchCount = document.getElementById('matchCountPreview');
            const numMatches = (selectedCount * (selectedCount - 1)) / 2;

            matchCount.textContent = `${numMatches} match${numMatches !== 1 ? 'es' : ''}`;

            preview.innerHTML = TEAMS.slice(0, selectedCount).map(team => `
                <span class="${team.color} ${team.text} px-3 py-1.5 rounded-lg text-xs font-medium">${team.name}</span>
            `).join('');
        }

        function startTournament() {
            teams = TEAMS.slice(0, selectedCount);
            matches = generateRoundRobinSchedule(teams);
            scores = {};
            matches.forEach((_, idx) => { scores[idx] = { home: '', away: '' }; });

            document.getElementById('setupSection').classList.add('hidden');
            document.getElementById('tournamentSection').classList.remove('hidden');

            updateStats();
            renderMatches();
            updateStandings();
            lucide.createIcons();
        }

        function generateRoundRobinSchedule(teams) {
            const schedule = [];
            const teamList = [...teams];
            if (teamList.length % 2 !== 0) teamList.push(null);

            const totalTeams = teamList.length;
            const rounds = totalTeams - 1;
            const matchesPerRound = totalTeams / 2;

            for (let round = 0; round < rounds; round++) {
                for (let match = 0; match < matchesPerRound; match++) {
                    const home = teamList[match];
                    const away = teamList[totalTeams - 1 - match];
                    if (home && away) {
                        schedule.push({ home, away, round: round + 1 });
                    }
                }
                const last = teamList.pop();
                teamList.splice(1, 0, last);
            }
            return schedule;
        }

        function renderMatches() {
            const container = document.getElementById('matchesContainer');
            container.innerHTML = matches.map((match, idx) => `
                <div class="px-6 py-4 flex items-center justify-between gap-4 hover:bg-zinc-800/30 transition-colors">
                    <div class="flex items-center gap-3 min-w-0 flex-1">
                        <span class="text-xs text-zinc-600 font-medium w-6">${idx + 1}</span>
                        <div class="flex items-center gap-2 min-w-0">
                            <span class="${match.home.color} ${match.home.text} px-2.5 py-1 rounded-md text-xs font-medium whitespace-nowrap">${match.home.name}</span>
                            <span class="text-zinc-600 text-xs">vs</span>
                            <span class="${match.away.color} ${match.away.text} px-2.5 py-1 rounded-md text-xs font-medium whitespace-nowrap">${match.away.name}</span>
                        </div>
                    </div>
                    <div class="flex items-center gap-2">
                        <input type="number"
                               id="score-${idx}-home"
                               min="0"
                               value="${scores[idx].home}"
                               onchange="updateScore(${idx}, 'home', this.value)"
                               class="w-12 h-9 bg-zinc-800 border border-zinc-700 rounded-lg text-center text-sm font-medium text-white focus:outline-none focus:border-violet-500 focus:ring-1 focus:ring-violet-500 transition-all">
                        <span class="text-zinc-600">-</span>
                        <input type="number"
                               id="score-${idx}-away"
                               min="0"
                               value="${scores[idx].away}"
                               onchange="updateScore(${idx}, 'away', this.value)"
                               class="w-12 h-9 bg-zinc-800 border border-zinc-700 rounded-lg text-center text-sm font-medium text-white focus:outline-none focus:border-violet-500 focus:ring-1 focus:ring-violet-500 transition-all">
                    </div>
                </div>
            `).join('');
        }

        function updateScore(matchIdx, side, value) {
            scores[matchIdx][side] = value === '' ? '' : parseInt(value);
            updateStats();
            updateStandings();
        }

        function updateStats() {
            document.getElementById('statTeams').textContent = teams.length;
            document.getElementById('statMatches').textContent = matches.length;

            let completed = 0;
            let totalGoals = 0;

            Object.values(scores).forEach(score => {
                if (score.home !== '' && score.away !== '') {
                    completed++;
                    totalGoals += score.home + score.away;
                }
            });

            document.getElementById('statCompleted').textContent = completed;
            document.getElementById('statGoals').textContent = totalGoals;
        }

        function updateStandings() {
            const standings = {};
            teams.forEach(team => {
                standings[team.name] = {
                    team,
                    wins: 0, draws: 0, losses: 0,
                    goalsFor: 0, goalsAgainst: 0,
                    points: 0, headToHead: {}
                };
            });

            matches.forEach((match, idx) => {
                const homeScore = scores[idx].home;
                const awayScore = scores[idx].away;

                if (homeScore !== '' && awayScore !== '') {
                    const home = standings[match.home.name];
                    const away = standings[match.away.name];

                    home.goalsFor += homeScore;
                    home.goalsAgainst += awayScore;
                    away.goalsFor += awayScore;
                    away.goalsAgainst += homeScore;

                    home.headToHead[match.away.name] = homeScore - awayScore;
                    away.headToHead[match.home.name] = awayScore - homeScore;

                    if (homeScore > awayScore) {
                        home.wins++; home.points += 3; away.losses++;
                    } else if (homeScore < awayScore) {
                        away.wins++; away.points += 3; home.losses++;
                    } else {
                        home.draws++; away.draws++;
                        home.points += 1; away.points += 1;
                    }
                }
            });

            const sorted = Object.values(standings).sort((a, b) => {
                if (b.points !== a.points) return b.points - a.points;
                const gdA = a.goalsFor - a.goalsAgainst;
                const gdB = b.goalsFor - b.goalsAgainst;
                if (gdB !== gdA) return gdB - gdA;
                if (b.goalsFor !== a.goalsFor) return b.goalsFor - a.goalsFor;
                const h2h = a.headToHead[b.team.name];
                if (h2h !== undefined && h2h !== 0) return -h2h;
                return 0;
            });

            const tbody = document.getElementById('standingsBody');
            tbody.innerHTML = sorted.map((team, idx) => {
                const gd = team.goalsFor - team.goalsAgainst;
                const rankStyle = idx === 0 ? 'text-yellow-400' : idx === 1 ? 'text-zinc-400' : idx === 2 ? 'text-orange-400' : 'text-zinc-500';
                return `
                    <tr class="border-b border-zinc-800/30 hover:bg-zinc-800/30 transition-colors">
                        <td class="py-3 px-6 ${rankStyle} font-medium">${idx + 1}</td>
                        <td class="py-3 px-4">
                            <span class="${team.team.color} ${team.team.text} px-2.5 py-1 rounded-md text-xs font-medium">${team.team.name}</span>
                        </td>
                        <td class="text-center py-3 px-2 text-emerald-400 font-medium">${team.wins}</td>
                        <td class="text-center py-3 px-2 text-zinc-400">${team.draws}</td>
                        <td class="text-center py-3 px-2 text-red-400">${team.losses}</td>
                        <td class="text-center py-3 px-2 text-zinc-400 hidden sm:table-cell">${team.goalsFor}</td>
                        <td class="text-center py-3 px-2 text-zinc-400 hidden sm:table-cell">${team.goalsAgainst}</td>
                        <td class="text-center py-3 px-2 ${gd > 0 ? 'text-emerald-400' : gd < 0 ? 'text-red-400' : 'text-zinc-500'}">${gd >= 0 ? '+' : ''}${gd}</td>
                        <td class="text-center py-3 px-6 font-semibold text-white">${team.points}</td>
                    </tr>
                `;
            }).join('');
        }

        function randomizeScores() {
            matches.forEach((_, idx) => {
                scores[idx] = {
                    home: Math.floor(Math.random() * 6),
                    away: Math.floor(Math.random() * 6)
                };
            });
            renderMatches();
            updateStats();
            updateStandings();
        }

        function clearScores() {
            matches.forEach((_, idx) => {
                scores[idx] = { home: '', away: '' };
            });
            renderMatches();
            updateStats();
            updateStandings();
        }

        function resetTournament() {
            document.getElementById('setupSection').classList.remove('hidden');
            document.getElementById('tournamentSection').classList.add('hidden');
            teams = [];
            matches = [];
            scores = {};
        }
    </script>
</body>
</html>
