<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Vibe Coded Data Visualizer</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
            color: #333;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            border-radius: 15px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
            overflow: hidden;
        }

        .header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 30px;
            text-align: center;
        }

        .header h1 {
            font-size: 2.5rem;
            margin-bottom: 10px;
        }

        .header p {
            opacity: 0.9;
            font-size: 1.1rem;
        }

        .controls {
            padding: 30px;
            background: #f8f9fa;
            border-bottom: 1px solid #dee2e6;
        }

        .control-group {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 20px;
        }

        .input-section {
            background: white;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.05);
        }

        .input-section h3 {
            margin-bottom: 15px;
            color: #495057;
            font-size: 1.1rem;
        }

        .data-input {
            width: 100%;
            height: 120px;
            padding: 15px;
            border: 2px solid #e9ecef;
            border-radius: 8px;
            font-family: 'Monaco', 'Menlo', monospace;
            font-size: 14px;
            resize: vertical;
            transition: border-color 0.3s;
        }

        .data-input:focus {
            outline: none;
            border-color: #667eea;
        }

        .chart-options {
            display: flex;
            flex-direction: column;
            gap: 15px;
        }

        .option-group {
            display: flex;
            flex-direction: column;
            gap: 8px;
        }

        .option-group label {
            font-weight: 600;
            color: #495057;
            font-size: 14px;
        }

        .option-group select, .option-group input {
            padding: 10px;
            border: 2px solid #e9ecef;
            border-radius: 6px;
            font-size: 14px;
            transition: border-color 0.3s;
        }

        .option-group select:focus, .option-group input:focus {
            outline: none;
            border-color: #667eea;
        }

        .action-buttons {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
        }

        .btn {
            padding: 12px 24px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-size: 14px;
            font-weight: 600;
            transition: all 0.2s;
            text-decoration: none;
            display: inline-block;
            text-align: center;
        }

        .btn-primary {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(102, 126, 234, 0.4);
        }

        .btn-secondary {
            background: #6c757d;
            color: white;
        }

        .btn-secondary:hover {
            background: #5a6268;
        }

        .btn-success {
            background: #28a745;
            color: white;
        }

        .btn-success:hover {
            background: #218838;
        }

        .chart-container {
            padding: 30px;
            min-height: 500px;
            position: relative;
        }

        .chart-wrapper {
            position: relative;
            height: 400px;
            background: white;
            border-radius: 10px;
            padding: 20px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
        }

        .sample-data {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
            margin-top: 15px;
        }

        .sample-btn {
            padding: 8px 16px;
            background: #e9ecef;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-size: 12px;
            transition: background-color 0.2s;
        }

        .sample-btn:hover {
            background: #dee2e6;
        }

        .stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 20px;
            margin-bottom: 20px;
            padding: 0 30px;
        }

        .stat-card {
            background: white;
            padding: 20px;
            border-radius: 10px;
            text-align: center;
            box-shadow: 0 2px 10px rgba(0,0,0,0.05);
        }

        .stat-number {
            font-size: 2rem;
            font-weight: bold;
            color: #667eea;
            margin-bottom: 5px;
        }

        .stat-label {
            color: #6c757d;
            font-size: 14px;
        }

        .error-message {
            background: #f8d7da;
            color: #721c24;
            padding: 15px;
            border-radius: 8px;
            margin: 20px 30px;
            border: 1px solid #f5c6cb;
        }

        .success-message {
            background: #d4edda;
            color: #155724;
            padding: 15px;
            border-radius: 8px;
            margin: 20px 30px;
            border: 1px solid #c3e6cb;
        }

        .empty-chart {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            height: 400px;
            color: #6c757d;
            text-align: center;
        }

        .empty-chart h3 {
            margin-bottom: 10px;
            font-size: 1.5rem;
        }

        @media (max-width: 768px) {
            .container {
                margin: 0;
                border-radius: 0;
                min-height: 100vh;
            }

            .control-group {
                grid-template-columns: 1fr;
            }

            .action-buttons {
                justify-content: center;
            }

            .chart-wrapper {
                height: 300px;
                padding: 10px;
            }

            .stats {
                grid-template-columns: repeat(2, 1fr);
                padding: 0 20px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üìä Data Visualizer</h1>
            <p>Transform your data into beautiful charts instantly</p>
        </div>

        <div class="stats" id="dataStats" style="display: none;">
            <div class="stat-card">
                <div class="stat-number" id="dataPointsCount">0</div>
                <div class="stat-label">Data Points</div>
            </div>
            <div class="stat-card">
                <div class="stat-number" id="dataAverage">0</div>
                <div class="stat-label">Average Value</div>
            </div>
            <div class="stat-card">
                <div class="stat-number" id="dataMax">0</div>
                <div class="stat-label">Maximum</div>
            </div>
            <div class="stat-card">
                <div class="stat-number" id="dataMin">0</div>
                <div class="stat-label">Minimum</div>
            </div>
        </div>

        <div class="chart-container">
            <div class="chart-wrapper">
                <div class="empty-chart" id="emptyChart">
                    <h3>üìà Ready to visualize!</h3>
                    <p>Enter your data below and click "Generate Chart" to get started.</p>
                    <p style="margin-top: 10px; font-size: 14px; color: #adb5bd;">Try one of the sample datasets for a quick demo.</p>
                </div>
                <canvas id="dataChart" style="display: none;"></canvas>
            </div>
        </div>

        <div class="controls">
            <div class="control-group">
                <div class="input-section">
                    <h3>üì• Data Input</h3>
                    <textarea id="dataInput" class="data-input" placeholder="Enter your data in JSON format:
[
  {&quot;name&quot;: &quot;January&quot;, &quot;value&quot;: 100},
  {&quot;name&quot;: &quot;February&quot;, &quot;value&quot;: 150},
  {&quot;name&quot;: &quot;March&quot;, &quot;value&quot;: 120}
]

Or CSV format:
name,value
January,100
February,150
March,120"></textarea>
                    <div class="sample-data">
                        <p style="font-size: 12px; color: #666; margin-bottom: 10px; width: 100%;">Quick samples:</p>
                        <button class="sample-btn" onclick="loadSampleData('sales')">Sales Data</button>
                        <button class="sample-btn" onclick="loadSampleData('survey')">Survey Results</button>
                        <button class="sample-btn" onclick="loadSampleData('performance')">Performance Metrics</button>
                        <button class="sample-btn" onclick="loadSampleData('demographics')">Demographics</button>
                    </div>
                </div>

                <div class="input-section">
                    <h3>‚öôÔ∏è Chart Options</h3>
                    <div class="chart-options">
                        <div class="option-group">
                            <label for="chartType">Chart Type</label>
                            <select id="chartType">
                                <option value="bar">Bar Chart</option>
                                <option value="line">Line Chart</option>
                                <option value="pie">Pie Chart</option>
                                <option value="doughnut">Doughnut Chart</option>
                                <option value="radar">Radar Chart</option>
                                <option value="polarArea">Polar Area</option>
                            </select>
                        </div>

                        <div class="option-group">
                            <label for="chartTitle">Chart Title</label>
                            <input type="text" id="chartTitle" placeholder="Enter chart title" value="My Data Visualization">
                        </div>

                        <div class="option-group">
                            <label for="colorScheme">Color Scheme</label>
                            <select id="colorScheme">
                                <option value="vibrant">Vibrant</option>
                                <option value="pastel">Pastel</option>
                                <option value="monochrome">Monochrome</option>
                                <option value="cool">Cool Tones</option>
                                <option value="warm">Warm Tones</option>
                            </select>
                        </div>
                    </div>

                    <div class="action-buttons">
                        <button class="btn btn-primary" onclick="generateChart()">üìä Generate Chart</button>
                        <button class="btn btn-secondary" onclick="exportChart()">üíæ Export PNG</button>
                        <button class="btn btn-success" onclick="exportData()">üìÑ Export Data</button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        class DataVisualizer {
            constructor() {
                this.chart = null;
                this.currentData = null;
                this.colorSchemes = {
                    vibrant: ['#FF6384', '#36A2EB', '#FFCE56', '#4BC0C0', '#9966FF', '#FF9F40', '#FF6384'],
                    pastel: ['#AED6F1', '#A9DFBF', '#F9E79F', '#F5B7B1', '#D2B4DE', '#AED6F1', '#85C1E9'],
                    monochrome: ['#2C3E50', '#34495E', '#5D6D7E', '#85929E', '#AEB6BF', '#D5DBDB', '#EAEDED'],
                    cool: ['#3498DB', '#2ECC71', '#1ABC9C', '#9B59B6', '#34495E', '#16A085', '#27AE60'],
                    warm: ['#E74C3C', '#F39C12', '#E67E22', '#D35400', '#C0392B', '#A93226', '#922B21']
                };
                
                this.sampleData = {
                    sales: {
                        title: 'Monthly Sales Data',
                        data: [
                            {name: 'January', value: 12000},
                            {name: 'February', value: 15000},
                            {name: 'March', value: 11000},
                            {name: 'April', value: 18000},
                            {name: 'May', value: 22000},
                            {name: 'June', value: 19000}
                        ]
                    },
                    survey: {
                        title: 'Customer Satisfaction Survey',
                        data: [
                            {name: 'Very Satisfied', value: 45},
                            {name: 'Satisfied', value: 32},
                            {name: 'Neutral', value: 15},
                            {name: 'Dissatisfied', value: 6},
                            {name: 'Very Dissatisfied', value: 2}
                        ]
                    },
                    performance: {
                        title: 'Website Performance Metrics',
                        data: [
                            {name: 'Page Load Time (s)', value: 2.3},
                            {name: 'Time to Interactive (s)', value: 3.1},
                            {name: 'First Paint (s)', value: 1.2},
                            {name: 'Largest Contentful Paint (s)', value: 2.8}
                        ]
                    },
                    demographics: {
                        title: 'Age Demographics',
                        data: [
                            {name: '18-25', value: 23},
                            {name: '26-35', value: 35},
                            {name: '36-45', value: 28},
                            {name: '46-55', value: 15},
                            {name: '56+', value: 12}
                        ]
                    }
                };
            }

            parseData(input) {
                try {
                    // Try JSON first
                    const jsonData = JSON.parse(input.trim());
                    if (Array.isArray(jsonData)) {
                        return jsonData;
                    }
                    throw new Error('JSON data must be an array');
                } catch (e) {
                    // Try CSV
                    const lines = input.trim().split('\n');
                    if (lines.length < 2) {
                        throw new Error('Invalid data format. Please provide JSON array or CSV data.');
                    }

                    const headers = lines[0].split(',').map(h => h.trim());
                    const data = [];

                    for (let i = 1; i < lines.length; i++) {
                        const values = lines[i].split(',').map(v => v.trim());
                        if (values.length !== headers.length) continue;

                        const row = {};
                        headers.forEach((header, index) => {
                            let value = values[index];
                            // Try to convert to number
                            const numValue = parseFloat(value);
                            row[header] = isNaN(numValue) ? value : numValue;
                        });
                        data.push(row);
                    }

                    return data;
                }
            }

            calculateStats(data) {
                if (!data || data.length === 0) return null;

                // Find numeric fields
                const numericFields = [];
                const firstRow = data[0];
                for (const key in firstRow) {
                    if (typeof firstRow[key] === 'number') {
                        numericFields.push(key);
                    }
                }

                if (numericFields.length === 0) return null;

                // Use first numeric field for stats
                const field = numericFields[0];
                const values = data.map(row => row[field]).filter(v => typeof v === 'number');

                if (values.length === 0) return null;

                const sum = values.reduce((a, b) => a + b, 0);
                const avg = sum / values.length;
                const max = Math.max(...values);
                const min = Math.min(...values);

                return {
                    count: data.length,
                    average: avg,
                    max: max,
                    min: min
                };
            }

            updateStats(stats) {
                const statsDiv = document.getElementById('dataStats');
                if (!stats) {
                    statsDiv.style.display = 'none';
                    return;
                }

                document.getElementById('dataPointsCount').textContent = stats.count;
                document.getElementById('dataAverage').textContent = stats.average.toFixed(1);
                document.getElementById('dataMax').textContent = stats.max;
                document.getElementById('dataMin').textContent = stats.min;
                statsDiv.style.display = 'grid';
            }

            generateChart() {
                const input = document.getElementById('dataInput').value.trim();
                const chartType = document.getElementById('chartType').value;
                const title = document.getElementById('chartTitle').value || 'Data Visualization';
                const colorScheme = document.getElementById('colorScheme').value;

                // Clear previous messages
                document.querySelectorAll('.error-message, .success-message').forEach(el => el.remove());

                if (!input) {
                    this.showMessage('Please enter some data to visualize.', 'error');
                    return;
                }

                try {
                    const data = this.parseData(input);
                    this.currentData = data;

                    // Calculate and show stats
                    const stats = this.calculateStats(data);
                    this.updateStats(stats);

                    // Prepare chart data
                    const labels = data.map(row => {
                        // Find the label field (first non-numeric field or 'name')
                        for (const key in row) {
                            if (key.toLowerCase().includes('name') || key.toLowerCase().includes('label') || typeof row[key] === 'string') {
                                return row[key];
                            }
                        }
                        return Object.keys(row)[0];
                    });

                    const values = data.map(row => {
                        // Find the value field (first numeric field or 'value')
                        for (const key in row) {
                            if (key.toLowerCase().includes('value') || key.toLowerCase().includes('amount') || typeof row[key] === 'number') {
                                return row[key];
                            }
                        }
                        return 0;
                    });

                    const colors = this.colorSchemes[colorScheme];

                    // Destroy existing chart
                    if (this.chart) {
                        this.chart.destroy();
                    }

                    // Hide empty state, show chart
                    document.getElementById('emptyChart').style.display = 'none';
                    const canvas = document.getElementById('dataChart');
                    canvas.style.display = 'block';

                    // Create new chart
                    const ctx = canvas.getContext('2d');
                    this.chart = new Chart(ctx, {
                        type: chartType,
                        data: {
                            labels: labels,
                            datasets: [{
                                label: 'Data',
                                data: values,
                                backgroundColor: colors,
                                borderColor: colors,
                                borderWidth: 2,
                                fill: chartType === 'line' ? false : true
                            }]
                        },
                        options: {
                            responsive: true,
                            maintainAspectRatio: false,
                            plugins: {
                                title: {
                                    display: true,
                                    text: title,
                                    font: {
                                        size: 16,
                                        weight: 'bold'
                                    }
                                },
                                legend: {
                                    display: ['pie', 'doughnut', 'polarArea'].includes(chartType)
                                }
                            },
                            scales: ['bar', 'line'].includes(chartType) ? {
                                y: {
                                    beginAtZero: true
                                }
                            } : {}
                        }
                    });

                    this.showMessage(`Chart generated successfully with ${data.length} data points!`, 'success');

                } catch (error) {
                    this.showMessage(`Error parsing data: ${error.message}`, 'error');
                }
            }

            exportChart() {
                if (!this.chart) {
                    this.showMessage('Please generate a chart first.', 'error');
                    return;
                }

                const canvas = document.getElementById('dataChart');
                const url = canvas.toDataURL('image/png');
                const a = document.createElement('a');
                a.href = url;
                a.download = 'chart.png';
                a.click();

                this.showMessage('Chart exported as PNG!', 'success');
            }

            exportData() {
                if (!this.currentData) {
                    this.showMessage('No data to export. Please generate a chart first.', 'error');
                    return;
                }

                const csv = this.convertToCSV(this.currentData);
                const blob = new Blob([csv], { type: 'text/csv' });
                const url = URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.href = url;
                a.download = 'data.csv';
                a.click();
                URL.revokeObjectURL(url);

                this.showMessage('Data exported as CSV!', 'success');
            }

            convertToCSV(data) {
                if (!data || data.length === 0) return '';

                const headers = Object.keys(data[0]);
                const csvRows = [];

                csvRows.push(headers.join(','));

                for (const row of data) {
                    const values = headers.map(header => {
                        const value = row[header];
                        return typeof value === 'string' ? `"${value}"` : value;
                    });
                    csvRows.push(values.join(','));
                }

                return csvRows.join('\n');
            }

            showMessage(message, type) {
                const messageDiv = document.createElement('div');
                messageDiv.className = `${type}-message`;
                messageDiv.textContent = message;
                document.querySelector('.controls').after(messageDiv);

                setTimeout(() => {
                    messageDiv.remove();
                }, 5000);
            }
        }

        // Global functions for HTML onclick
        let visualizer;

        function loadSampleData(type) {
            const sample = visualizer.sampleData[type];
            document.getElementById('dataInput').value = JSON.stringify(sample.data, null, 2);
            document.getElementById('chartTitle').value = sample.title;
        }

        function generateChart() {
            visualizer.generateChart();
        }

        function exportChart() {
            visualizer.exportChart();
        }

        function exportData() {
            visualizer.exportData();
        }

        // Initialize
        document.addEventListener('DOMContentLoaded', () => {
            visualizer = new DataVisualizer();
            
            // Load sample data by default
            setTimeout(() => {
                loadSampleData('sales');
            }, 500);
        });
    </script>
</body>
</html>